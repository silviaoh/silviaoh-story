---
title: '[JavaScript.5] 실행 컨텍스트'
date: 2021-09-10 22:09:52
category: 'JavaScript'
draft: false
---

> 이 글은 `코어 자바스크립트`를 참고하여 학습용으로 작성한 글입니다.

## 실행 컨텍스트란(Execution Context)?

실행 컨텍스트는 자바스크립트에서 중요한 핵심 개념 중 하나이다.
`코드`, `환경 정보`, `객체` 3가지를 기억해서 연상하자. 실행 컨텍스트는 **실행할 코드에 제공할 환경 정보들을 모아놓은 객체**이다.
우리가 자바스크립트 코드를 작성한 뒤에 실행하면 자바스크립트 엔진이 코드를 실행할 때 필요한 `컨텍스트`라는 것을 구성하고 이것을 Call Stack에 쌓아올렸다가, 가장 위에 있는 `컨텍스트`를 실행한다.

> 💡 여기서 잠깐! 스택(Stack)과 큐(Queue)란?
>
> - 스택(Stack)은 **출입구가 하나뿐인 깊은 우물**같은 데이터 구조이다. 입구도 출구도 하나만 존재하기 때문에 만약 a,b,c,d를 차례대로 저장했다면 꺼낼 때는 반대로 d,c,b,a 순으로 꺼낼 수밖에 없을 것이다. 이렇게 저장할 때는 차례대로 저장되고 출력할 때는 마지막부터 출력되는 것을 `LIFO(Last In First Out)` 구조라고 한다.
> - 큐(Queue)는 **양쪽이 모두 열려있는 파이프**같은 데이터 구조이다. 양쪽 모두 입력과 출력이 가능한 구조도 있지만 보통은 **한쪽은 입력, 반대쪽은 출력만을 담당하는 구조**로 되어 있다. 그렇기 때문에 a,b,c,d를 차례대로 저장했다면 꺼낼 때도 a,b,c,d 순서대로 꺼낼 수밖에 없다. 먼저 집어넣은 데이터가 먼저 나오기 때문에 `FIFO(First In First Out)` 구조라고 한다.

## Example로 보는 실행 컨텍스트 & Call Stack 동작 과정

다음과 같은 코드가 있다. 이 코드를 실행했을 때 Call Stack에 실행 컨텍스트가 어떻게 쌓이고 어떤 순서로 코드 실행에 관여를 할까?

```javascript
// ------------------- [1]
var a = 1

function outer() {
  function inner() {
    console.log(a)
    var a = 3
  }
  inner() // ---------------------[2]
  console.log(a)
}

outer() // -----------------------[3]
console.log(a)
```

![](https://images.velog.io/images/silviaoh/post/bc9f6dcc-cdf3-4446-b94e-5147f244827e/123502647-ea50eb00-d688-11eb-93e7-27bc3e2f8892.png)

그림을 참고해서 설명하자면 **처음 코드가 실행되었을 때** 즉, **자바스크립트 파일이 열리는 순간** Call Stack에 `전역 컨텍스트`가 담긴다. Call Stack에는 전역 컨텍스트 외에 다른 컨텍스트가 없기 때문에 전역 컨텍스트와 관련된 코드들을 순차적으로 처리한다.

코드의 [3]번 부분에 도착하여 outer 함수를 실행하면 **outer 함수에 대한 환경 변수를 수집**해서 `outer 실행 컨텍스트`를 생성한 후 Call Stack에 담는다. 이 때, `전역 컨텍스트`와 관련된 코드를 일시중지하고 `outer 실행 컨텍스트`와 관련된 코드들을 순차적으로 실행한다.

[2]를 만나면 outer 실행 컨텍스트가 생성된 것처럼 `inner 실행 컨텍스트`도 생성되고 Call Stack에 담겨져서 코드가 실행된다. inner 함수의 실행 컨텍스트가 가장 위에 담겨졌기 때문에 outer 함수의 실행 컨텍스트와 관련된 코드는 중단되고 inner 함수 내부의 코드를 순차적으로 실행한다.

inner 함수 내부에서 a에 3을 할당하고 함수가 종료되면 그 즉시 inner 실행 컨텍스트가 Call Stack에서 제거된다. 그러면 outer 컨텍스트가 스택의 맨 위에 존재하게 되므로 outer 함수 내부의 코드에서 중단되었던 [2]의 다음 줄 `console.log(a)`가 실행되며 a의 값을 출력한다.

값을 출력하고 나면 outer 함수의 실행도 종료되고 outer 실행 컨텍스트도 제거되어 전역 컨텍스트만 남아있게 된다. 그런 다음, 실행이 중단되었던 전역 공간 [3]의 다음 줄에서 a를 출력하고 전역 컨텍스트도 제거되어 스택에는 아무것도 남아있지 않은 상태로 종료된다.

## ✅ 정리

- 실행 컨텍스트는 `실행할 코드`에 제공할 `환경 정보`를 모아두는 `객체`이다.
- **함수가 실행될 때** 실행 컨텍스트가 생성된 후 곧바로 콜 스택에 담긴다.
- 한 실행 컨텍스트가 **스택의 맨 위**에 놓이면 이전의 실행 컨텍스트와 관련된 코드의 실행을 일시중단하고 대신 최신 실행 컨택스트와 관련된 코드들을 순차적으로 실행한다.
- **함수의 실행이 종료**되면 전역 컨텍스트도 제거된다.
